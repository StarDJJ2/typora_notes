基于pytorch框架，帮我写一段代码， 满足以下功能：

1. 我现在有两个模态的数据集，RGB和FIR的，分别包含一定数量的图片，并且还有其图片所对应的csv标签文件。写一段代码分别读取这两组数据集，和对应的标签。并且将这两组数据集分别分为0.8的训练集和0.2的测试集。

2. 对训练集进行transform的数据增强，要求包括水平翻转，垂直翻转和随机旋转

3. 读取完成后，将两个数据集的名称分别设置为rgb_dataset和fir_dataset。

4. 这两个数据集将使用在双模态输入网络中，所以在输入双分支的网络结构中时，要求两个数据集输入的图片相匹配，顺序一一对应

5. 最后将两个模态的数据集封装到dataloader中，batch_size=32