# 通道标志位

DMA通道1中的标志位如下：

- **DMA1_FLAG_GL1:** 全局传输完成标志位。该标志位指示DMA通道1的所有传输都已完成。
- **DMA1_FLAG_TC1:** 传输完成标志位。该标志位指示DMA通道1当前传输已完成。
- **DMA1_FLAG_HT1:** 半传输完成标志位。该标志位指示DMA通道1当前传输已完成一半。
- **DMA1_FLAG_TE1:** 传输错误标志位。该标志位指示DMA通道1传输过程中发生错误。

**以下是这几个标志位的详细解释：**

**DMA1_FLAG_GL1:** 全局传输完成标志位

该标志位指示DMA通道1的所有传输都已完成。当所有传输完成时，该标志位会被硬件置位。软件可以通过读取DMA_ISR寄存器的GL1位来检查该标志位的状态。

**DMA1_FLAG_TC1:** 传输完成标志位

该标志位指示DMA通道1当前传输已完成。当当前传输完成时，该标志位会被硬件置位。软件可以通过读取DMA_ISR寄存器的TC1位来检查该标志位的状态。

**DMA1_FLAG_HT1:** 半传输完成标志位

该标志位指示DMA通道1当前传输已完成一半。当当前传输完成一半时，该标志位会被硬件置位。软件可以通过读取DMA_ISR寄存器的HT1位来检查该标志位的状态。

**DMA1_FLAG_TE1:** 传输错误标志位

该标志位指示DMA通道1传输过程中发生错误。当传输过程中发生错误时，该标志位会被硬件置位。软件可以通过读取DMA_ISR寄存器的TE1位来检查该标志位的状态。

**软件可以使用这些标志位来监控DMA通道1的状态。**例如，软件可以等待DMA1_FLAG_TC1标志位置位，然后再进行下一步操作。或者，软件可以使用DMA1_FLAG_TE1标志位来检测传输错误。

**以下是一些使用这些标志位的例子：**

- **等待DMA通道1传输完成:**

C

```
// 等待DMA通道1传输完成
while ((DMA_ISR->TC1) == RESET);

// 进行下一步操作
```

- **检测DMA通道1传输错误:**

C

```
// 检查DMA通道1传输是否发生错误
if (DMA_ISR->TE1 == SET) {

// 处理传输错误

}
```



DMA不涉及外围硬件电路，所以可以在<font color='red'>System</font>中添加

# 传输方向

在STM32的DMA（Direct Memory Access）配置中，这两个宏定义表示DMA数据传输的方向，即数据是从外设传输到内存（Peripheral to Memory）还是从内存传输到外设（Memory to Peripheral）。

1. **`DMA_DIR_PeripheralDST`：**
   - 该宏定义表示DMA数据传输方向为从外设到内存，即外设的数据会被传输到内存中。

2. **`DMA_DIR_PeripheralSRC`：**
   - 该宏定义表示DMA数据传输方向为从内存到外设，即内存中的数据会被传输到外设。

在使用DMA时，你需要根据实际的数据传输方向选择相应的宏定义，以确保DMA的配置正确。这样可以避免数据传输方向错误导致的问题，例如读取到无效数据或者将错误的数据写入外设。



<font color='red'>自动重装和软件触发不能同时使用</font>

<font color='red'>当M2M为1时，执行软件触发；当M2M为0时，执行特定通道的硬件触发</font>

在变量a前添加Const关键字，将变量a定义在Flash里，然后将变量a进行转运，就可以实现<font color='red'>Flash到SRAM的转运</font>



# DMA数据转运一般可以用在的任务

DMA数据转运可以用于任何需要在不同存储器之间搬移数据的任务，例如：

**1. 外设与内存之间的数据传输**

DMA可以用于将外设产生的数据传输到内存，或者将内存中的数据传输到外设。例如：

- 将ADC采集的数据传输到内存
- 将图像数据从内存传输到LCD显示屏
- 将音频数据从内存传输到DAC

**2. 内存与内存之间的数据传输**

DMA可以用于在不同的内存区域之间搬移数据。例如：

- 将数据从一个缓冲区复制到另一个缓冲区
- 将数据从SRAM复制到Flash
- 将数据从SDRAM复制到外部存储器

**3. 特殊功能**

DMA还可以用于一些特殊功能，例如：

- 在DMA控制器支持的情况下，可以用于实现零拷贝数据传输，提高数据传输效率。
- 可以用于实现多通道数据传输，提高数据传输并发性。
- 可以用于实现DMA与其他外设协同工作，完成更复杂的功能。

**DMA数据转运的优势**

DMA数据转运具有以下优势：

- **提高数据传输效率：**DMA可以利用CPU空闲时间进行数据传输，提高数据传输效率。
- **减轻CPU负担：**DMA可以减轻CPU的数据传输负担，使CPU可以专注于其他任务。
- **提高数据传输可靠性：**DMA可以减少数据传输错误的可能性。

**DMA数据转运的劣势**

DMA数据转运也具有一些劣势：

- **增加系统复杂度：**使用DMA需要增加系统的复杂度，需要配置DMA控制器和DMA通道。
- **增加功耗：**DMA会增加系统的功耗。

**实例**

以下是一些DMA数据转运的实例：

- **STM32 ADC采集数据**

在STM32中，可以使用DMA将ADC采集的数据传输到内存。这可以减轻CPU的负担，提高数据采集效率。

- **STM32 DAC播放音频**

在STM32中，可以使用DMA将内存中的音频数据传输到DAC。这可以提高音频播放的流畅性。

- **STM32图像显示**

在STM32中，可以使用DMA将内存中的图像数据传输到LCD显示屏。这可以提高图像显示的刷新率。

**总结**

DMA数据转运是一种高效的数据传输方式，可以用于各种需要在不同存储器之间搬移数据的任务。